Tutorial: The code for optimizing the parameters of the NPZD model at Station ALOHA (DOI: 10.5281/zenodo.5168823) is written in Fortran90 with the Intel Fortran compiler (version 2021.1) used. We have tested the codes on a GNU/Linux cluster with x86-64 architechture. The user is supposed to be familiar with the Fortran language and has some basic knowledge of BASH. Below we give some instructions and explanations of the codes and model outputs.
1) Go to the directory you want to run the model (we assume that the root directory is under home directory: ~/).
2) To download the codes, type: "git clone https://github.com/BingzhangChen/HOT.git".
3) Type: "cd GeiderDroop/HOT" to go to the working directory.
4) Type: "vi jobcomp" to change the setting for model run: 
Test = 0 means a fast run, usually for a formal model run for a large number of iterations. Test = 1 means running a model for debugging, which is much slower than the fast run. The user can also modify the compiler flags depending on the purpose in the script. The user needs to confirm the directory where the library of mpifort or mpiifort exists.
5) Type "./jobcomp", the model will compile and an executable (DRAM) will be generated. 
6) Type "vi Model.nml", which contains two namelists. The namelist &paramlist contains the initial, minimal and maximal parameter values. The namelist &MCMCrun contains the options for defining the total length of the MCMC chain which is at least 2 (nruns), the number of the ensemble runs (EnsLen), the number of years for each model run (NYear), whether the model should start from previous runs (Readfile = 1) or start a new run (Readfile = 0), the number of runs in the historical files (NR_enspar), and whether to use parallel computing (MPIRUN = 1 is always recommended).
7) After defining all the model settings, type “./DRAM” and then the model will run and some outputs will be shown on the screen. Type “./DRAM > out” to make the model outputs stored in the “out” file. For each model run, the model saves the current parameters into the “enspar” file and the current values of σ and SSqE into the ‘enssig’ file. In this way, even if the model crashes, the user can pick up the current parameter position and updated parameter covariance matrix. The model also generates the files of best parameters, best σ and SSqE files, best model output files that correspond to observational data, and model output files at daily resolution at each grid after an ensemble run. After completing the MCMC chain, the model uses the best set of parameter to generate the best model output file (HOT.out).
Two types of physics forcing data including vertical profiles of eddy diffusive coefficients (HOT_Aks.dat) and temperatures (HOT_temp.dat) have been provided for Station ALOHA. Nitrate data from World Ocean Atlas 2013 (HOT_NO3.dat) are also provided for initial conditions of dissolved inorganic nitrogen (DIN) and bottom boundary conditions of nitrate. The temporal resolution is one day for the vertical eddy diffusivity and one month for temperature and nitrate. Four types of observational data, DIN (HOT_DIN.dat), chlorophyll (HOT_CHL.dat), primary production (HOT_PP.dat), and particulate organic nitrogen (HOT_PON.dat) (last assessed 8 July 2021). 
